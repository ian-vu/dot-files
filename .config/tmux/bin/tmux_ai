#!/bin/bash

# This script helps with pane toggling of panes with AI agents.
# The aim is to have the agent running on the left pane.

# Set the process name to look for - currently claude cli runs under "node"
ai_process="node"
ai_process_command="$HOME/.claude/local/claude"
current_command=$(tmux display-message -p "#{pane_current_command}")
ai_pane=$(tmux list-panes -F "#{pane_id} #{pane_current_command}" | grep -m1 "${ai_process}$" | cut -d" " -f1)

# Case 1: No AI process running - split and start claude
if [ -z "$ai_pane" ]; then
  tmux split-window -h -l "35%" -b "zsh -c '$ai_process_command; exec zsh'"
  # tmux split-window -h -l 80 "$ai_process_command"

# Case 2: Currently in AI process pane - swap to right pane and maximize effective hiding AI
elif [[ "$current_command" == "$ai_process" ]]; then
  tmux select-pane -R
  tmux resize-pane -Z

# Case 3: AI process is running and current pane is maximized - go to AI pane directly
elif [[ $(tmux display-message -p "#{window_zoomed_flag}") == "1" ]]; then
  tmux select-pane -t "$ai_pane"

# Case 4: AI process is running but current pane isn't AI process - close hide the pane
else
  tmux resize-pane -Z
fi
